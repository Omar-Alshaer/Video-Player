<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Video Player</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Video Player</h1>
        <p>Paste your video share link below to play it. Use the rotation buttons to adjust the video orientation.</p>
        <input type="text" id="video-url" placeholder="Paste video link here...">
        <button onclick="loadVideo()">Load Video</button>
        <div id="video-container">
            <iframe id="video-iframe"></iframe>
        </div>
        <div class="controls">
            <button onclick="rotateVideoClockwise()" title="Rotate Right">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M23 4v6h-6"></path>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                </svg>
                Rotate Right
            </button>
            <button onclick="rotateVideoCounterClockwise()" title="Rotate Left">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 4v6h6"></path>
                    <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                </svg>
                Rotate Left
            </button>
            <button onclick="toggleFullscreen()" title="Toggle Fullscreen">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
                </svg>
                Fullscreen
            </button>
        </div>
        <div id="error-message" class="error"></div>
        <footer>&copy; 2025 Video Player. All rights reserved (Omar Elshaer).</footer>
    </div>

    <script>
        let currentRotation = 0;

        function loadVideo() {
            const urlInput = document.getElementById('video-url').value;
            const errorMessage = document.getElementById('error-message');
            const iframe = document.getElementById('video-iframe');
            const container = document.getElementById('video-container');
            errorMessage.textContent = '';

            // Extract file ID from video URL (assuming Google Drive format)
            const match = urlInput.match(/\/d\/([a-zA-Z0-9_-]+)/);
            if (!match) {
                errorMessage.textContent = 'Invalid video link. Please ensure it\'s a valid share link.';
                return;
            }

            const fileId = match[1];
            const embedUrl = `https://drive.google.com/file/d/${fileId}/preview`;
            iframe.src = embedUrl;
            currentRotation = 0;
            updateVideoTransform();
        }

        function rotateVideoClockwise() {
            currentRotation = (currentRotation + 90) % 360;
            updateVideoTransform();
        }

        function rotateVideoCounterClockwise() {
            currentRotation = (currentRotation - 90 + 360) % 360;
            updateVideoTransform();
        }

        function updateVideoTransform() {
            const iframe = document.getElementById('video-iframe');
            const container = document.getElementById('video-container');
            const is90or270 = currentRotation === 90 || currentRotation === 270;

            // Reset iframe styles to avoid compounding transforms
            iframe.style.transform = '';
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.left = '0';
            iframe.style.top = '0';

            // Adjust container aspect ratio and padding
            container.style.aspectRatio = is90or270 ? '9 / 16' : '16 / 9';
            container.style.padding = is90or270 ? '10px' : '0';

            // Apply rotation to iframe only
            if (is90or270) {
                iframe.style.width = '180%'; // Slightly increased to ensure visibility
                iframe.style.height = '100%';
                iframe.style.left = '50%';
                iframe.style.top = '50%';
                iframe.style.transform = `translate(-50%, -50%) rotate(${currentRotation}deg)`;
            } else {
                iframe.style.transform = `rotate(${currentRotation}deg)`;
            }
        }

        function toggleFullscreen() {
            const container = document.getElementById('video-container');
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }
    </script>
</body>
</html>